<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<recordset table="ScriptLibrary">
  <record id="name=&quot;SmartEmailAssignmentUtil&quot;" recordid="SmartEmailAssignmentUtil">
    <name type="string">SmartEmailAssignmentUtil</name>
    <script type="string">
/**
*   is out of office
*
*   @param {entry} - SCFile
*	@return - true/false
*   @type - Boolean - true/false
**/
function isOutOfOffice(entry) {
	var assignment = entry['assignment'];
	
	if(!assignment){
		return false;
	}
	if((typeof assignment)!="string"){
		assignment = assignment[0];
	}
	
	var fAssignment = new SCFile("assignment", SCFILE_READONLY);
	fAssignment.setFields(['name', 'time.zone']);
	var query="name=\""+assignment+"\"";
	
	var rc = fAssignment.doSelect(query);
	var timeZone = null;
	var workSch = null;
	if (rc == RC_SUCCESS) {
		timeZone = fAssignment['time.zone'];
		workSch = fAssignment['calendar.name'];
	}

	if (workSch) {
		return !(lib.AssignmentUtil.assignmentGroupIsAvailable(workSch, timeZone));
	}
	
	return false;
}</script>
    <package type="string">SmartEmail</package>
    <sysmodtime type="dateTime">05/09/16 22:04:36</sysmodtime>
    <sysmoduser type="string">falcon</sysmoduser>
    <sysmodcount type="decimal">34</sysmodcount>
    <prgnsystem NullValue="1" type="boolean"/>
    <sysrestricted NullValue="1" type="boolean"/>
  </record>
</recordset>
