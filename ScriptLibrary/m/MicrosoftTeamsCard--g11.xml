<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<recordset table="ScriptLibrary">
  <record id="name=&quot;MicrosoftTeamsCard&quot;" recordid="MicrosoftTeamsCard">
    <name type="string">MicrosoftTeamsCard</name>
    <script type="string">/**
 * generate adaptive card object
 *
 * @see https://adaptivecards.io/explorer/
 *
 * @param {String} title
 * @param {String} subtitle
 * @param {String} text
 * @param {Array} facts
 * @param {String} url
 * @returns {Object}
 */
function adaptiveCard(title, subtitle, text, facts, url) {
    var card = {
        "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
        "type": "AdaptiveCard",
        "version": "1.3",
        "body": [{
                "type": "TextBlock",
                "text": title,
                "weight": "bolder",
                "size": "large",
                "wrap": true
            },
            {
                "type": "TextBlock",
                "text": subtitle,
                "wrap": true,
                "isSubtle": true
            },
            {
                "type": "TextBlock",
                "text": text,
                "wrap": true
            }
        ],
        "actions": [{
            "type": "Action.OpenUrl",
            "title": funcs.scmsg("19", "msteams"),
            "url": url
        }]
    };

    if (facts &amp;&amp; facts.length &gt; 0) {
        var factset = generateFactSetObj(facts);
        card.body.push(factset);
    }

    return card;
}


function generateFactSetObj(facts) {

    var factsObj = [];
    facts.forEach(function(fact) {
        factsObj.push({
            "title": fact[0],
            "value": fact[1] || ""
        });
    });

    return {
        "type": "FactSet",
        "separator": true,
        "facts": factsObj
    };
}</script>
    <package type="string">MicrosoftTeams</package>
    <sysmodtime type="dateTime">06/15/21 00:48:40</sysmodtime>
    <sysmoduser type="string">falcon</sysmoduser>
    <sysmodcount type="decimal">0</sysmodcount>
    <prgnsystem NullValue="1" type="boolean"/>
    <sysrestricted type="boolean">true</sysrestricted>
  </record>
</recordset>
