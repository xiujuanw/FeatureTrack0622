<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<recordset table="ScriptLibrary">
  <record id="name=&quot;EncryptUtil&quot;" recordid="EncryptUtil">
    <name type="string">EncryptUtil</name>
    <script type="string">/**
 *  Check if the string matches the format of encrypted
 *  The format start from FEFE and end with EFEF
 *  There are more than 30 characters of number or upper case letter between them
 *  Actually, the minimum length of total encrypted string is 40
 */
function isEncrypted(str) {
    if (str == null) {
        return false;
    }
    
    // RTE function "encrypt" encrypts to one object, need to convert to string
    if (typeof(str) == "object") {
        str = funcs.str(str);
    }
    
    return /^FEFE[0-9A-F]{30,}EFEF$/.test(str);
}

/**
 *  Encrypt the string if it is not encrypted
 *  If the string matches the format of encrypted, only return itself
 */
function encrypt(str) {
    if (!isEncrypted(str)) {
        var encrypted = new Datum();
        var ret = funcs.encrypt(encrypted, str);
        if (ret) {
            return funcs.str(encrypted);
        }
    }
    
    return str;
}

/**
 *  Decrypt the string if it is encrypted.
 *  If the string doesn't match the format of encrypted, only return itself
 */
function decrypt(str) {
    if (isEncrypted(str)) {
        var decrypted = new Datum();
        var ret = funcs.decrypt(decrypted, str);
        if (ret) {
            return funcs.str(decrypted);
        }
    }
    
    return str;
}
</script>
    <package type="string">BaseUtilities</package>
    <sysmodtime type="dateTime">09/03/20 19:01:21</sysmodtime>
    <sysmoduser type="string">zhouanqing</sysmoduser>
    <sysmodcount type="decimal">5</sysmodcount>
    <prgnsystem NullValue="1" type="boolean"/>
    <sysrestricted type="boolean">true</sysrestricted>
  </record>
</recordset>
