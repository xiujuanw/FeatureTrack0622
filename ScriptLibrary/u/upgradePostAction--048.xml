<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<recordset table="ScriptLibrary">
  <record id="name=&quot;upgradePostAction&quot;" recordid="upgradePostAction">
    <name type="string">upgradePostAction</name>
    <script type="string">function executePostActionUpdate(upgradestatus) {
    lib.upgradeCommonHelper.fixSystemData();
    
	// deprecate legacy content pack information
	lib.upgradeCommonHelper.deprecateLegacyContentPack();
    
    lib.upgradeMaldatasPurge.compileDisplayScreen();
    
    enableRelationManager(upgradestatus.option);
    
	// expire globallists
	lib.upgradeLog.detail(funcs.scmsg(419, "upg"));
	lib.upgradeCommonHelper.expireGlobalLists();
	lib.upgradeLog.detail(funcs.scmsg(420, "upg"));

    // print post upgrade prompt message
    var msg = lib.upgradeCommonHelper.getPostUpgradePromptMessage();
    if (msg.length &gt; 0) {
    	lib.upgradeLog.detail(msg);
    	print(msg);
    }
}


function enableRelationManager(option) {
    lib.upgradeLog.upgrade("Enable Relation.");
    lib.upgradeLog.detail("Enable Relation.");
    var err;
    funcs.rtecall("trigger", err, 1);
    funcs.rtecall("counter", err, 1);
    if (option == "unconditional") {
        lib.RelationManagerEnablement.enableRelationManager();
    } else {
        lib.c.$("#referenceService").buildRelations();
    }
    funcs.rtecall("counter", err, 0);
    funcs.rtecall("trigger", err, 0);
}</script>
    <package type="string">Upgrade</package>
    <sysmodtime type="dateTime">07/31/16 21:42:32</sysmodtime>
    <sysmoduser type="string">zhangqi</sysmoduser>
    <sysmodcount type="decimal">17</sysmodcount>
    <prgnsystem NullValue="1" type="boolean"/>
    <sysrestricted type="boolean">true</sysrestricted>
  </record>
</recordset>
