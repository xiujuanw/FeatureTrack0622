<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<recordset table="ScriptLibrary">
  <record id="name=&quot;KMEngineFactory&quot;" recordid="KMEngineFactory">
    <name type="string">KMEngineFactory</name>
    <script type="string">var logger = getLog('KMEngineFactory');

var KMEngineFactory = (function() {

  function isIDOLEnabled() {
    if (vars['$G.bg']) {
      var IDOLConfigure = lib.IDOLConfigure.require();
      // make sure read from database.
      IDOLConfigure.clearIDOLServerConfigCache();
      var config = IDOLConfigure.getConfig();
      return config['enable'];
    } else {
      return vars['$lo.idol.enabled'];
    }
  }

  function createKMEngine() {
    if (isIDOLEnabled()) {
      return lib.IDOLKMEngine.require();
    } else {
//      throw new Error('No search engine found');
      logger.warn('No search engine found');
      return lib.PseudoKMEngine.require();
    }
  }

  return {
    create : function() {
      var engine = createKMEngine();
      logger.trace('using search engine: ' + engine.name);
      return engine;
    }
  };
}());

function require() {
  return KMEngineFactory;
}</script>
    <package type="string">KnowledgeManagement</package>
    <sysmodtime type="dateTime">06/15/21 00:48:38</sysmodtime>
    <sysmoduser type="string">falcon</sysmoduser>
    <sysmodcount type="decimal">0</sysmodcount>
    <prgnsystem NullValue="1" type="boolean"/>
    <sysrestricted NullValue="1" type="boolean"/>
  </record>
</recordset>
